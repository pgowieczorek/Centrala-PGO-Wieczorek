<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Supla Panel</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background: #f0f2f5; }
        .card { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; min-width: 250px; }
        h2 { color: #666; font-size: 18px; text-transform: uppercase; letter-spacing: 1px; }
        #wynik { font-size: 60px; font-weight: bold; color: #00d151; margin: 20px 0; }
        .status { font-size: 12px; color: #999; }
    </style>
</head>
<body>

<div class="card">
    <h2>Temperatura</h2>
    <div id="wynik">...</div>
    <div id="update" class="status">Inicjalizacja...</div>
</div>

<script>
    // TWOJE DANE
    const mojLink = 'https://svr155.supla.org/direct/37/rJ5ahEY67sG_Q6j/read';
    
    // Używamy bramki CORS, która rozwiązuje problem "Ładowania..."
    const proxyUrl = 'https://corsproxy.io/?' + encodeURIComponent(mojLink);

    async function pobierzDane() {
        const wynikDiv = document.getElementById('wynik');
        const updateDiv = document.getElementById('update');
        
        try {
            const response = await fetch(proxyUrl);
            
            if (!response.ok) throw new Error('Błąd serwera');
            
            const data = await response.json();
            console.log("Odebrano:", data);

            // Wyciąganie temperatury (sprawdza różne możliwe nazwy pól)
            let t = data.temperature ?? data.temp ?? (data.state ? data.state.temp : null) ?? (data.state ? data.state.temperature : null);

            if (t !== null) {
                wynikDiv.innerText = parseFloat(t).toFixed(1) + "°C";
                updateDiv.innerText = "Aktualizacja: " + new Date().toLocaleTimeString();
            } else {
                wynikDiv.innerText = "???";
                updateDiv.innerText = "Brak pola temperatury w danych";
            }

        } catch (error) {
            console.error(error);
            wynikDiv.innerText = "BŁĄD";
            updateDiv.innerText = "Problem z połączeniem";
        }
    }

    // Start
    pobierzDane();
    // Odświeżaj co 15 sekund
    setInterval(pobierzDane, 15000);
</script>

</body>
</html>
